{% extends 'base.html' %}
{% load static %}

{% block title %}Tambah Kegiatan - EVENT VIBE{% endblock %}

{% block content %}
<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="glass-card fade-in-up">
                <div class="text-center mb-4">
                    <h2 class="text-gradient mb-2" style="font-size: 2.5rem; font-weight: 900;">
                        <i class="bi bi-lightning-charge-fill"></i> Create Epic Event
                    </h2>
                    <p class="text-white-50">Fill in the details to create your amazing event!</p>
                </div>
                
                <form method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    {% if form.non_field_errors %}
                        <div class="alert mb-3" style="background: rgba(236, 72, 153, 0.2); border: 2px solid var(--pink-neon); border-radius: 15px; color: #fff;">
                            <i class="bi bi-exclamation-triangle"></i> {{ form.non_field_errors }}
                        </div>
                    {% endif %}
                    
                    <div class="mb-3">
                        <label for="{{ form.title.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                            <i class="bi bi-bookmark-fill"></i> Judul Kegiatan *
                        </label>
                        {{ form.title }}
                        {% if form.title.errors %}
                            <div class="text-danger small mt-1">{{ form.title.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="mb-3">
                        <label for="{{ form.category.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                            <i class="bi bi-tags-fill"></i> Kategori Event *
                        </label>
                        <select name="{{ form.category.name }}" id="{{ form.category.id_for_label }}" class="form-control" required style="background-color: #FFFFFF !important; color: #1F2937 !important; border: 1px solid #E5E7EB; border-radius: 10px; padding: 0.75rem;">
                            <option value="" disabled selected style="background: #FFFFFF; color: #9CA3AF;">-- Pilih Kategori Event --</option>
                            <option value="seminar" style="background: #FFFFFF; color: #1F2937;">Seminar & Conference</option>
                            <option value="concert" style="background: #FFFFFF; color: #1F2937;">Concert & Festival</option>
                        </select>
                        {% if form.category.errors %}
                            <div class="text-danger small mt-1">{{ form.category.errors }}</div>
                        {% endif %}
                        <small class="text-white-50 d-block mt-2">
                            <i class="bi bi-info-circle"></i> Pilih kategori event yang sesuai (Seminar & Conference atau Concert & Festival)
                        </small>
                    </div>
                    
                    <div class="mb-3">
                        <label for="{{ form.description.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                            <i class="bi bi-file-text-fill"></i> Deskripsi Kegiatan *
                        </label>
                        {{ form.description }}
                        {% if form.description.errors %}
                            <div class="text-danger small mt-1">{{ form.description.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.event_date.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                <i class="bi bi-calendar3-fill"></i> Tanggal Kegiatan *
                            </label>
                            {{ form.event_date }}
                            {% if form.event_date.errors %}
                                <div class="text-danger small mt-1">{{ form.event_date.errors }}</div>
                            {% endif %}
                            <small class="text-white-50 d-block mt-2">
                                <i class="bi bi-info-circle"></i> Minimal H-3 dari hari ini
                            </small>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.event_time.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                <i class="bi bi-clock-fill"></i> Waktu Kegiatan *
                            </label>
                            {{ form.event_time }}
                            {% if form.event_time.errors %}
                                <div class="text-danger small mt-1">{{ form.event_time.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="{{ form.location_type.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                            <i class="bi bi-geo-alt-fill"></i> Tipe Lokasi *
                        </label>
                        <select name="{{ form.location_type.name }}" id="{{ form.location_type.id_for_label }}" class="form-control" required style="background-color: #FFFFFF !important; color: #1F2937 !important; border: 1px solid #E5E7EB; border-radius: 10px; padding: 0.75rem;" onchange="toggleLocationFields()">
                            <option value="offline" style="background: #FFFFFF; color: #1F2937;">Offline</option>
                            <option value="online" style="background: #FFFFFF; color: #1F2937;">Online</option>
                            <option value="hybrid" style="background: #FFFFFF; color: #1F2937;">Hybrid</option>
                        </select>
                        {% if form.location_type.errors %}
                            <div class="text-danger small mt-1">{{ form.location_type.errors }}</div>
                        {% endif %}
                    </div>
                    
                    <div class="mb-3" id="location-field">
                        <label for="{{ form.location.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                            <i class="bi bi-geo-alt-fill"></i> Lokasi Kegiatan *
                        </label>
                        {{ form.location }}
                        {% if form.location.errors %}
                            <div class="text-danger small mt-1">{{ form.location.errors }}</div>
                        {% endif %}
                        <small class="text-white-50 d-block mt-2">
                            <i class="bi bi-info-circle"></i> Alamat lengkap lokasi event (untuk offline/hybrid)
                        </small>
                    </div>
                    
                    <div class="mb-3" id="zoom-fields" style="display: none;">
                        <label for="{{ form.zoom_link.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                            <i class="bi bi-camera-video-fill"></i> Link Zoom Meeting
                        </label>
                        {{ form.zoom_link }}
                        {% if form.zoom_link.errors %}
                            <div class="text-danger small mt-1">{{ form.zoom_link.errors }}</div>
                        {% endif %}
                        <small class="text-white-50 d-block mt-2">
                            <i class="bi bi-info-circle"></i> Contoh: https://zoom.us/j/1234567890
                        </small>
                        
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <label for="{{ form.zoom_meeting_id.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                    <i class="bi bi-hash"></i> Meeting ID
                                </label>
                                {{ form.zoom_meeting_id }}
                                {% if form.zoom_meeting_id.errors %}
                                    <div class="text-danger small mt-1">{{ form.zoom_meeting_id.errors }}</div>
                                {% endif %}
                            </div>
                            <div class="col-md-6">
                                <label for="{{ form.zoom_passcode.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                    <i class="bi bi-key-fill"></i> Passcode
                                </label>
                                {{ form.zoom_passcode }}
                                {% if form.zoom_passcode.errors %}
                                    <div class="text-danger small mt-1">{{ form.zoom_passcode.errors }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="{{ form.price.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                <i class="bi bi-currency-dollar"></i> Harga Tiket
                            </label>
                            {{ form.price }}
                            {% if form.price.errors %}
                                <div class="text-danger small mt-1">{{ form.price.errors }}</div>
                            {% endif %}
                            <small class="text-white-50 d-block mt-2">
                                <i class="bi bi-info-circle"></i> Kosongkan jika event gratis
                            </small>
                        </div>
                        
                        <div class="col-md-4">
                            <label for="{{ form.bank_name.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                <i class="bi bi-bank"></i> Nama Bank
                            </label>
                            {{ form.bank_name }}
                            {% if form.bank_name.errors %}
                                <div class="text-danger small mt-1">{{ form.bank_name.errors }}</div>
                            {% endif %}
                            <small class="text-white-50 d-block mt-2">
                                <i class="bi bi-info-circle"></i> Contoh: BCA, Mandiri, BRI
                            </small>
                        </div>
                        
                        <div class="col-md-4">
                            <label for="{{ form.bank_account.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                <i class="bi bi-credit-card"></i> Nomor Rekening
                            </label>
                            {{ form.bank_account }}
                            {% if form.bank_account.errors %}
                                <div class="text-danger small mt-1">{{ form.bank_account.errors }}</div>
                            {% endif %}
                            <small class="text-white-50 d-block mt-2">
                                <i class="bi bi-info-circle"></i> Untuk pembayaran event
                            </small>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.flyer.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                <i class="bi bi-image-fill"></i> Flyer Kegiatan
                            </label>
                            {{ form.flyer }}
                            {% if form.flyer.errors %}
                                <div class="text-danger small mt-1">{{ form.flyer.errors }}</div>
                            {% endif %}
                            <small class="text-white-50 d-block mt-2">
                                <i class="bi bi-info-circle"></i> Max 5MB, format JPG/PNG
                            </small>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.certificate_template.id_for_label }}" class="form-label" style="color: var(--blue-light); font-weight: 600;">
                                <i class="bi bi-file-earmark-pdf-fill"></i> Template Sertifikat
                            </label>
                            {{ form.certificate_template }}
                            {% if form.certificate_template.errors %}
                                <div class="text-danger small mt-1">{{ form.certificate_template.errors }}</div>
                            {% endif %}
                            <small class="text-white-50 d-block mt-2">
                                <i class="bi bi-info-circle"></i> Max 10MB, format PDF/Gambar
                            </small>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                        <a href="{% url 'events:list' %}" class="btn" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: #fff;">
                            <i class="bi bi-x-circle"></i> Batal
                        </a>
                        <button type="submit" class="btn btn-vibrant">
                            <i class="bi bi-lightning-charge-fill"></i> Create Event
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
function toggleLocationFields() {
    const locationType = document.getElementById('{{ form.location_type.id_for_label }}').value;
    const locationField = document.getElementById('location-field');
    const zoomFields = document.getElementById('zoom-fields');
    const locationInput = document.getElementById('{{ form.location.id_for_label }}');
    const zoomLinkInput = document.getElementById('{{ form.zoom_link.id_for_label }}');
    
    if (locationType === 'online') {
        locationField.style.display = 'none';
        zoomFields.style.display = 'block';
        if (locationInput) locationInput.required = false;
        if (zoomLinkInput) zoomLinkInput.required = true;
    } else if (locationType === 'hybrid') {
        locationField.style.display = 'block';
        zoomFields.style.display = 'block';
        if (locationInput) locationInput.required = true;
        if (zoomLinkInput) zoomLinkInput.required = true;
    } else {
        locationField.style.display = 'block';
        zoomFields.style.display = 'none';
        if (locationInput) locationInput.required = true;
        if (zoomLinkInput) zoomLinkInput.required = false;
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    toggleLocationFields();
});
</script>
{% endblock %}
